CREATE OR REPLACE PROCEDURE MANAGE_TASK(P_DATABASE STRING, P_SCHEMA STRING, P_TABLE STRING, P_OPERATION STRING)
RETURNS STRING
LANGUAGE SQL
AS
$$
DECLARE
  V_FULL_TABLE_NAME STRING;
  V_TASK STRING;
  VS_MANAGE_TASK_SQL STRING;
BEGIN
  V_FULL_TABLE_NAME := P_DATABASE || '_' || P_SCHEMA || '_' || P_TABLE;
  V_TASK := V_FULL_TABLE_NAME || '_TASK';
  
  IF P_OPERATION = 'RESUME' THEN
    VS_MANAGE_TASK_SQL := 'ALTER TASK ' || V_TASK || ' RESUME;';
  ELSIF P_OPERATION = 'SUSPEND' THEN
    VS_MANAGE_TASK_SQL := 'ALTER TASK ' || V_TASK || ' SUSPEND;';
  ELSE
    RETURN 'Invalid OPERATION. Use RESUME or SUSPEND.';
  END IF;
  
  EXECUTE IMMEDIATE VS_MANAGE_TASK_SQL;
  
  RETURN 'Task ' || V_TASK || ' has been ' || LOWER(P_OPERATION) || 'd successfully.';
END;
$$;
